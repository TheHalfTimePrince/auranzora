'use client';

import { useRef, useCallback } from 'react';
import gsap from 'gsap';

interface LogoTextAnimatedProps {
  className?: string;
}

// SVG path data for the shadow/back layer (used for masking the gradient)
const shadowPathData = `M7.8,38.8c2.8,3,6.4,4.5,10.8,4.5s3.6-.4,4.9-1.2c1.3-.8,1.9-1.9,1.9-3.3s-.4-2.2-1.1-2.7c-.8-.5-1.8-.8-3.1-.8l-6.1-.5c-2.9-.3-5.2-1.3-7-3-1.8-1.7-2.8-4-2.8-7,0-3.6,1.3-6.3,3.7-8.2,2.4-1.8,5.4-2.7,9-2.7s3,.1,4.2.3c1.3.2,2.4.5,3.5,1,2.1.9,4,2.1,5.7,3.6l-4.3,5.1c-1.3-1-2.7-1.8-4.2-2.4-1.5-.6-3.1-.9-5-.9s-3.7.4-4.5,1.2c-.9.8-1.4,1.8-1.4,3.1,0,.8.3,1.5,1,2.1.7.7,1.8,1.1,3.5,1.3l5.7.4c3.6.3,6.1,1.4,7.7,3.3,1.5,1.9,2.2,4.3,2.2,7.2,0,3.4-1.4,6.1-4,7.9-2.6,1.9-6,2.9-10.1,2.9-5.6,0-10.6-2.1-15-6.3l4.8-4.9Z M40.2,14.3h6.9v21c0,2.4.6,4.2,1.9,5.6,1.3,1.3,2.9,2,4.9,2s3.6-.7,4.8-2c1.3-1.3,1.9-3.2,1.9-5.6V14.3h6.9v35.3h-6.9v-3.8h-.1c-2.3,2.8-5.2,4.2-8.8,4.2-2.8,0-5.4-1.1-7.7-3.2-2.5-2-3.7-5-3.8-9V14.3Z M77.6,0h6.9v18c1.2-1.2,2.6-2.3,4.1-3.1,1.4-.7,2.9-1.1,4.7-1.1,4.2.1,7.2,1.7,9.2,4.6.9,1.1,1.6,2.6,1.9,4.4.3,1.8.5,4.8.5,9s-.2,7.2-.5,9c-.4,1.9-1,3.4-1.9,4.5-.9,1.4-2.2,2.4-3.7,3.3-1.5.8-3.3,1.3-5.5,1.3-3.6,0-6.5-1.5-8.8-4.1v3.7h-6.9V0ZM91.2,20.9c-1.5,0-2.8.3-3.7,1-.9.7-1.6,1.5-2.1,2.6-.4,1.1-.7,2.2-.8,3.5-.1,1.2-.2,2.6-.2,3.9s0,2.5.2,3.8c.1,1.3.4,2.5.8,3.6.4,1.1,1.1,1.9,2.1,2.6.9.7,2.1,1,3.7,1s2.9-.3,3.9-1c.9-.7,1.6-1.5,2-2.5.4-1.1.7-2.3.9-3.6,0-1.3,0-2.6,0-3.9s0-2.8,0-4.1c-.2-1.2-.5-2.4-.9-3.5-.4-1.1-1.1-1.9-2-2.5-.9-.6-2.2-.9-3.9-.9Z M113.7,0h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V0Z M131.8,0h6.9v7.1h-6.9V0ZM131.8,14.3h6.9v35.3h-6.9V14.3Z M148,14.3h6.9v3.7h.1c2.3-2.8,5.4-4.2,9.2-4.2,2.4,0,4.4.5,5.9,1.3,1.5.9,2.8,2,4,3.4,2.8-3.1,6.5-4.7,11.1-4.6,2.9,0,5.6,1,8,3.1,2.4,2.1,3.6,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2,3.2-2,5.6v21h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2.1,3.2-2.1,5.6v21h-6.9V14.3Z M207.8,0h6.9v7.1h-6.9V0ZM207.8,14.3h6.9v35.3h-6.9V14.3Z M224.3,14.3h6.9v3.7h.1c2.3-2.8,5.2-4.2,8.9-4.2s5.4,1,7.8,3.1c2.3,2.1,3.5,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.6-4.4-1.9-5.6-1.3-1.3-2.9-2-4.8-2s-3.6.7-4.9,2c-1.3,1.3-1.9,3.2-1.9,5.6v21h-6.9V14.3Z M279.6,46.4h-.1c-.6,1.2-1.6,2.1-3,2.6-1.3.6-3.1.9-5.5.9-3.8,0-6.8-1.1-8.8-3.1-2.2-2-3.3-4.5-3.3-7.6s.9-5.4,2.8-7.4c1.9-2,4.6-3,8.3-3.1h9.5v-3.7c0-3.1-2.3-4.6-7-4.5-1.7,0-3.1.2-4,.5-1,.4-1.8,1.2-2.4,2.2l-5.4-4.3c2.6-3.5,6.5-5.2,11.5-5.1,4.3,0,7.7.8,10.3,2.5,2.6,1.8,3.9,4.8,3.9,9.1v24.1h-6.9v-3.1ZM279.6,34.6h-8.2c-4,0-6,1.5-5.9,4.3,0,1.2.5,2.2,1.5,3.1,1,.9,2.6,1.4,4.9,1.4,2.9,0,4.9-.3,6.1-1.1,1.1-.7,1.6-2.4,1.6-5.1v-2.6Z M296.4,0h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V0Z`;

export const LogoTextAnimated = ({ className = '' }: LogoTextAnimatedProps) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const gradientRef = useRef<HTMLDivElement>(null);
  const spotlightRef = useRef<HTMLDivElement>(null);

  const handleMouseMove = useCallback((e: React.MouseEvent<HTMLDivElement>) => {
    if (!containerRef.current || !spotlightRef.current) return;
    
    const rect = containerRef.current.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    // Use GSAP for smooth spotlight following
    gsap.to(spotlightRef.current, {
      '--mouse-x': `${x}px`,
      '--mouse-y': `${y}px`,
      duration: 0.15,
      ease: 'power2.out',
    });
  }, []);

  const handleMouseEnter = () => {
    if (!gradientRef.current) return;
    gsap.to(gradientRef.current, {
      opacity: 1,
      duration: 0.3,
      ease: 'power2.out',
    });
  };

  const handleMouseLeave = () => {
    if (!gradientRef.current) return;
    gsap.to(gradientRef.current, {
      opacity: 0,
      duration: 0.3,
      ease: 'power2.out',
    });
  };

  // Create the SVG mask URL for shadow layer
  const svgMaskUrl = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 308.2 52.7'%3E%3Cpath d='${encodeURIComponent(shadowPathData)}'/%3E%3C/svg%3E")`;

  return (
    <div
      ref={containerRef}
      className={`relative cursor-pointer ${className}`}
      onMouseEnter={handleMouseEnter}
      onMouseLeave={handleMouseLeave}
      onMouseMove={handleMouseMove}
    >
      {/* Shadow layer as static dark - sits behind everything */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 308.2 52.7"
        className="h-full w-auto absolute inset-0 z-0"
      >
        <g>
          <path fill="#333" d="M7.8,38.8c2.8,3,6.4,4.5,10.8,4.5s3.6-.4,4.9-1.2c1.3-.8,1.9-1.9,1.9-3.3s-.4-2.2-1.1-2.7c-.8-.5-1.8-.8-3.1-.8l-6.1-.5c-2.9-.3-5.2-1.3-7-3-1.8-1.7-2.8-4-2.8-7,0-3.6,1.3-6.3,3.7-8.2,2.4-1.8,5.4-2.7,9-2.7s3,.1,4.2.3c1.3.2,2.4.5,3.5,1,2.1.9,4,2.1,5.7,3.6l-4.3,5.1c-1.3-1-2.7-1.8-4.2-2.4-1.5-.6-3.1-.9-5-.9s-3.7.4-4.5,1.2c-.9.8-1.4,1.8-1.4,3.1,0,.8.3,1.5,1,2.1.7.7,1.8,1.1,3.5,1.3l5.7.4c3.6.3,6.1,1.4,7.7,3.3,1.5,1.9,2.2,4.3,2.2,7.2,0,3.4-1.4,6.1-4,7.9-2.6,1.9-6,2.9-10.1,2.9-5.6,0-10.6-2.1-15-6.3l4.8-4.9Z"/>
          <path fill="#333" d="M40.2,14.3h6.9v21c0,2.4.6,4.2,1.9,5.6,1.3,1.3,2.9,2,4.9,2s3.6-.7,4.8-2c1.3-1.3,1.9-3.2,1.9-5.6V14.3h6.9v35.3h-6.9v-3.8h-.1c-2.3,2.8-5.2,4.2-8.8,4.2-2.8,0-5.4-1.1-7.7-3.2-2.5-2-3.7-5-3.8-9V14.3Z"/>
          <path fill="#333" d="M77.6,0h6.9v18c1.2-1.2,2.6-2.3,4.1-3.1,1.4-.7,2.9-1.1,4.7-1.1,4.2.1,7.2,1.7,9.2,4.6.9,1.1,1.6,2.6,1.9,4.4.3,1.8.5,4.8.5,9s-.2,7.2-.5,9c-.4,1.9-1,3.4-1.9,4.5-.9,1.4-2.2,2.4-3.7,3.3-1.5.8-3.3,1.3-5.5,1.3-3.6,0-6.5-1.5-8.8-4.1v3.7h-6.9V0ZM91.2,20.9c-1.5,0-2.8.3-3.7,1-.9.7-1.6,1.5-2.1,2.6-.4,1.1-.7,2.2-.8,3.5-.1,1.2-.2,2.6-.2,3.9s0,2.5.2,3.8c.1,1.3.4,2.5.8,3.6.4,1.1,1.1,1.9,2.1,2.6.9.7,2.1,1,3.7,1s2.9-.3,3.9-1c.9-.7,1.6-1.5,2-2.5.4-1.1.7-2.3.9-3.6,0-1.3,0-2.6,0-3.9s0-2.8,0-4.1c-.2-1.2-.5-2.4-.9-3.5-.4-1.1-1.1-1.9-2-2.5-.9-.6-2.2-.9-3.9-.9Z"/>
          <path fill="#333" d="M113.7,0h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V0Z"/>
          <path fill="#333" d="M131.8,0h6.9v7.1h-6.9V0ZM131.8,14.3h6.9v35.3h-6.9V14.3Z"/>
          <path fill="#333" d="M148,14.3h6.9v3.7h.1c2.3-2.8,5.4-4.2,9.2-4.2,2.4,0,4.4.5,5.9,1.3,1.5.9,2.8,2,4,3.4,2.8-3.1,6.5-4.7,11.1-4.6,2.9,0,5.6,1,8,3.1,2.4,2.1,3.6,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2,3.2-2,5.6v21h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2.1,3.2-2.1,5.6v21h-6.9V14.3Z"/>
          <path fill="#333" d="M207.8,0h6.9v7.1h-6.9V0ZM207.8,14.3h6.9v35.3h-6.9V14.3Z"/>
          <path fill="#333" d="M224.3,14.3h6.9v3.7h.1c2.3-2.8,5.2-4.2,8.9-4.2s5.4,1,7.8,3.1c2.3,2.1,3.5,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.6-4.4-1.9-5.6-1.3-1.3-2.9-2-4.8-2s-3.6.7-4.9,2c-1.3,1.3-1.9,3.2-1.9,5.6v21h-6.9V14.3Z"/>
          <path fill="#333" d="M279.6,46.4h-.1c-.6,1.2-1.6,2.1-3,2.6-1.3.6-3.1.9-5.5.9-3.8,0-6.8-1.1-8.8-3.1-2.2-2-3.3-4.5-3.3-7.6s.9-5.4,2.8-7.4c1.9-2,4.6-3,8.3-3.1h9.5v-3.7c0-3.1-2.3-4.6-7-4.5-1.7,0-3.1.2-4,.5-1,.4-1.8,1.2-2.4,2.2l-5.4-4.3c2.6-3.5,6.5-5.2,11.5-5.1,4.3,0,7.7.8,10.3,2.5,2.6,1.8,3.9,4.8,3.9,9.1v24.1h-6.9v-3.1ZM279.6,34.6h-8.2c-4,0-6,1.5-5.9,4.3,0,1.2.5,2.2,1.5,3.1,1,.9,2.6,1.4,4.9,1.4,2.9,0,4.9-.3,6.1-1.1,1.1-.7,1.6-2.4,1.6-5.1v-2.6Z"/>
          <path fill="#333" d="M296.4,0h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V0Z"/>
        </g>
      </svg>

      {/* Gradient with spotlight reveal on shadow layer - sits above base shadow, below main text */}
      <div
        ref={gradientRef}
        className="absolute inset-0 opacity-0 pointer-events-none z-5"
        style={{
          WebkitMaskImage: svgMaskUrl,
          WebkitMaskSize: 'contain',
          WebkitMaskRepeat: 'no-repeat',
          WebkitMaskPosition: 'center',
          maskImage: svgMaskUrl,
          maskSize: 'contain',
          maskRepeat: 'no-repeat',
          maskPosition: 'center',
        }}
      >
        {/* Inner spotlight layer with radial gradient that follows mouse */}
        <div
          ref={spotlightRef}
          className="absolute inset-0"
          style={{
            '--mouse-x': '50%',
            '--mouse-y': '50%',
            background: 'linear-gradient(135deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff, #5f27cd, #ff6b6b)',
            backgroundSize: '400% 400%',
            animation: 'gradientShift 4s ease infinite',
            WebkitMaskImage: 'radial-gradient(circle 80px at var(--mouse-x) var(--mouse-y), black 0%, transparent 100%)',
            maskImage: 'radial-gradient(circle 80px at var(--mouse-x) var(--mouse-y), black 0%, transparent 100%)',
          } as React.CSSProperties}
        />
      </div>

      {/* Main text layer - sits on top */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 308.2 52.7"
        className="h-full w-auto relative z-10"
      >
        <g>
          <path fill="#fff" d="M4.8,41.5c2.8,3,6.4,4.5,10.8,4.5s3.6-.4,4.9-1.2c1.3-.8,1.9-1.9,1.9-3.3s-.4-2.2-1.1-2.7c-.8-.5-1.8-.8-3.1-.8l-6.1-.5c-2.9-.3-5.2-1.3-7-3-1.8-1.7-2.8-4-2.8-7,0-3.6,1.3-6.3,3.7-8.2,2.4-1.8,5.4-2.7,9-2.7s3,.1,4.2.3c1.3.2,2.4.5,3.5,1,2.1.9,4,2.1,5.7,3.6l-4.3,5.1c-1.3-1-2.7-1.8-4.2-2.4-1.5-.6-3.1-.9-5-.9s-3.7.4-4.5,1.2c-.9.8-1.4,1.8-1.4,3.1,0,.8.3,1.5,1,2.1.7.7,1.8,1.1,3.5,1.3l5.7.4c3.6.3,6.1,1.4,7.7,3.3,1.5,1.9,2.2,4.3,2.2,7.2,0,3.4-1.4,6.1-4,7.9-2.6,1.9-6,2.9-10.1,2.9-5.6,0-10.6-2.1-15-6.3l4.8-4.9Z"/>
          <path fill="#fff" d="M37.2,17h6.9v21c0,2.4.6,4.2,1.9,5.6,1.3,1.3,2.9,2,4.9,2s3.6-.7,4.8-2c1.3-1.3,1.9-3.2,1.9-5.6v-21h6.9v35.3h-6.9v-3.8h-.1c-2.3,2.8-5.2,4.2-8.8,4.2-2.8,0-5.4-1.1-7.7-3.2-2.5-2-3.7-5-3.8-9v-23.5Z"/>
          <path fill="#fff" d="M74.6,2.8h6.9v18c1.2-1.2,2.6-2.3,4.1-3.1,1.4-.7,2.9-1.1,4.7-1.1,4.2.1,7.2,1.7,9.2,4.6.9,1.1,1.6,2.6,1.9,4.4.3,1.8.5,4.8.5,9s-.2,7.2-.5,9c-.4,1.9-1,3.4-1.9,4.5-.9,1.4-2.2,2.4-3.7,3.3-1.5.8-3.3,1.3-5.5,1.3-3.6,0-6.5-1.5-8.8-4.1v3.7h-6.9V2.8ZM88.2,23.6c-1.5,0-2.8.3-3.7,1-.9.7-1.6,1.5-2.1,2.6-.4,1.1-.7,2.2-.8,3.5-.1,1.2-.2,2.6-.2,3.9s0,2.5.2,3.8c.1,1.3.4,2.5.8,3.6.4,1.1,1.1,1.9,2.1,2.6.9.7,2.1,1,3.7,1s2.9-.3,3.9-1c.9-.7,1.6-1.5,2-2.5.4-1.1.7-2.3.9-3.6,0-1.3,0-2.6,0-3.9s0-2.8,0-4.1c-.2-1.2-.5-2.4-.9-3.5-.4-1.1-1.1-1.9-2-2.5-.9-.6-2.2-.9-3.9-.9Z"/>
          <path fill="#fff" d="M110.7,2.8h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V2.8Z"/>
          <path fill="#fff" d="M128.8,2.8h6.9v7.1h-6.9V2.8ZM128.8,17h6.9v35.3h-6.9V17Z"/>
          <path fill="#fff" d="M145,17h6.9v3.7h.1c2.3-2.8,5.4-4.2,9.2-4.2,2.4,0,4.4.5,5.9,1.3,1.5.9,2.8,2,4,3.4,2.8-3.1,6.5-4.7,11.1-4.6,2.9,0,5.6,1,8,3.1,2.4,2.1,3.6,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2,3.2-2,5.6v21h-6.9v-21c0-2.5-.7-4.4-2-5.6-1.3-1.3-3-2-5.1-2s-3.8.7-5.1,2c-1.4,1.3-2.1,3.2-2.1,5.6v21h-6.9V17Z"/>
          <path fill="#fff" d="M204.8,2.8h6.9v7.1h-6.9V2.8ZM204.8,17h6.9v35.3h-6.9V17Z"/>
          <path fill="#fff" d="M221.3,17h6.9v3.7h.1c2.3-2.8,5.2-4.2,8.9-4.2s5.4,1,7.8,3.1c2.3,2.1,3.5,5.1,3.7,9.2v23.4h-6.9v-21c0-2.5-.6-4.4-1.9-5.6-1.3-1.3-2.9-2-4.8-2s-3.6.7-4.9,2c-1.3,1.3-1.9,3.2-1.9,5.6v21h-6.9V17Z"/>
          <path fill="#fff" d="M276.6,49.2h-.1c-.6,1.2-1.6,2.1-3,2.6-1.3.6-3.1.9-5.5.9-3.8,0-6.8-1.1-8.8-3.1-2.2-2-3.3-4.5-3.3-7.6s.9-5.4,2.8-7.4c1.9-2,4.6-3,8.3-3.1h9.5v-3.7c0-3.1-2.3-4.6-7-4.5-1.7,0-3.1.2-4,.5-1,.4-1.8,1.2-2.4,2.2l-5.4-4.3c2.6-3.5,6.5-5.2,11.5-5.1,4.3,0,7.7.8,10.3,2.5,2.6,1.8,3.9,4.8,3.9,9.1v24.1h-6.9v-3.1ZM276.6,37.3h-8.2c-4,0-6,1.5-5.9,4.3,0,1.2.5,2.2,1.5,3.1,1,.9,2.6,1.4,4.9,1.4,2.9,0,4.9-.3,6.1-1.1,1.1-.7,1.6-2.4,1.6-5.1v-2.6Z"/>
          <path fill="#fff" d="M293.4,2.8h6.9v40.5c0,1.6.9,2.4,2.6,2.4h2.4v6.7h-3.1c-2.5,0-4.6-.6-6.2-1.9-1.7-1.3-2.6-3.5-2.6-6.6V2.8Z"/>
        </g>
      </svg>
    </div>
  );
};
